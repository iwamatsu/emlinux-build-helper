# boot test emlinux / QEMU arm
device_type: qemu
job_name: QEMU arm , boot test with emlinux

timeouts:
  job:
    minutes: 15
  action:
    minutes: 5
  connection:
    minutes: 2
priority: medium
visibility: public

context:
  arch: arm
  memory: 512
  # comment out or change to user if the dispatcher does not support bridging.
  # netdevice: tap
  machine: virt
  cpu: cortex-a15

actions:
- deploy:
    timeout:
      minutes: 3
    to: tmpfs
    os:
    images:
      kernel:
        image_arg: '-kernel {kernel} -append "console=ttyAMA0,115200 root=/dev/vda rw highres=off debug verbose"'
        url: DEPLOY_DIR/zImage
      rootfs:
        image_arg: '-drive id=disk0,file={rootfs},if=none,format=raw -device virtio-blk-device,drive=disk0'
        url: DEPLOY_DIR/core-image-minimal-qemuarm.ext4 
# BOOT_BLOCK
- boot:
    timeout:
      minutes: 2
    method: qemu
    media: tmpfs
    auto_login:
      login_prompt: "qemuarm login:"
      username: root
    prompts:
      - "root@qemuarm:~# "
