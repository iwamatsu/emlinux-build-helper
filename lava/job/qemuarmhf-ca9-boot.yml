device_type: qemu
job_name: QEMU armhf ca9 , boot test

timeouts:
  job:
    minutes: 15
  action:
    minutes: 5
  connection:
    minutes: 2
priority: medium
visibility: public

context:
  arch: arm
  memory: 512
  # comment out or change to user if the dispatcher does not support bridging.
  # netdevice: tap
  machine: vexpress-a9
  cpu: cortex-a9
  model: model=lan9118
  extra_options:
  - -smp
  - 1

actions:
- deploy:
    timeout:
      minutes: 3
    to: tmpfs
    os:
    images:
      kernel:
        image_arg: '-kernel {kernel} -append "console=ttyAMA0,115200 root=/dev/mmcblk0"'
        url: DEPLOY_DIR/zImage
      dtb:
        image_arg: '-dtb {dtb}'
        url: DEPLOY_DIR/vexpress-v2p-ca9-qemuarmhf-ca9.dtb
      rootfs:
        image_arg: '-drive file={rootfs},if=sd,format=raw'
        url: DEPLOY_DIR/core-image-minimal-qemuarmhf-ca9.ext4 
# BOOT_BLOCK
- boot:
    timeout:
      minutes: 2
    method: qemu
    media: tmpfs
    auto_login:
      login_prompt: "qemuarmhf-ca9 login:"
      username: root
    prompts:
      - "root@qemuarmhf-ca9:~# "

